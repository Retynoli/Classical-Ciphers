#ifndef DECRYPTION_H
#define DECRYPTION_H

#include <QString>
#include <QMap>
#include <QMessageBox>

class Decryption
{
private:

    QString alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    QMap <QString, double> bigramsFreqsStandart = {{"OC", 0.1333384}, {"TA", 0.4067254}, {"PE", 0.3927781}, {"HA", 1.7533862}, {"EP", 0.1284976},
                                                    {"ON", 1.4637513}, {"LY", 0.4366810}, {"EW", 0.1074089}, {"ID", 0.4131479}, {"WI", 0.5180165},
                                                    {"CO", 0.6017964}, {"WA", 0.7742928}, {"KN", 0.1178095}, {"RE", 1.7554471}, {"EX", 0.1552899},
                                                    {"HO", 0.7850289}, {"HT", 0.2339893}, {"TO", 1.1336164}, {"BY", 0.1159882}, {"AW", 0.1056355},
                                                    {"IV", 0.1765225}, {"ME", 1.0261117}, {"AS", 1.1904123}, {"SS", 0.3641165}, {"KE", 0.3602822},
                                                    {"CI", 0.1234171}, {"EM", 0.2827810}, {"GE", 0.3587964}, {"IR", 0.3141266}, {"OF", 0.8852484},
                                                    {"UL", 0.4280059}, {"LM", 0.1593160}, {"EI", 0.1148858}, {"DS", 0.1273953}, {"AM", 0.3072248},
                                                    {"AR", 0.9913153}, {"RK", 0.1053479}, {"DO", 0.3965645}, {"ES", 1.0640235}, {"BA", 0.1554337},
                                                    {"AG", 0.1888881}, {"WO", 0.2980224}, {"OT", 0.4721485}, {"FR", 0.2388781}, {"EV", 0.2652390},
                                                    {"DI", 0.2823017}, {"OV", 0.1414864}, {"SI", 0.4520183}, {"MO", 0.3124491}, {"WN", 0.1516473},
                                                    {"EY", 0.1752284}, {"UT", 0.5242952}, {"OS", 0.2433834}, {"RO", 0.6651585}, {"CL", 0.1495864},
                                                    {"NE", 0.7579970}, {"DR", 0.1308941}, {"UG", 0.1809799}, {"LA", 0.4516828}, {"NS", 0.3018088},
                                                    {"FE", 0.2252662}, {"FI", 0.2207609}, {"YO", 0.6294035}, {"PP", 0.1200142}, {"TE", 0.9009212},
                                                    {"OR", 1.0262555}, {"IE", 0.2681148}, {"EE", 0.5119775}, {"TL", 0.1617124}, {"TS", 0.2503810},
                                                    {"MU", 0.1292166}, {"GO", 0.1641089}, {"BE", 0.6146893}, {"AI", 0.4906970}, {"UC", 0.1287373},
                                                    {"US", 0.4861917}, {"NC", 0.2857047}, {"TH", 3.9283557}, {"UR", 0.6653502}, {"ET", 0.4489029},
                                                    {"ER", 2.1172151}, {"EF", 0.1511201}, {"IN", 2.2636382}, {"PL", 0.1756118}, {"CT", 0.2344207},
                                                    {"IG", 0.2644722}, {"SA", 0.3689094}, {"PR", 0.2487035}, {"BU", 0.2697443}, {"OL", 0.4180366},
                                                    {"AD", 0.5948467}, {"RD", 0.2515793}, {"RL", 0.1019450}, {"YE", 0.1527018}, {"CK", 0.2258414},
                                                    {"OM", 0.5926419}, {"PO", 0.3729834}, {"NG", 1.0051188}, {"NA", 0.1754680}, {"DA", 0.1481485},
                                                    {"AV", 0.3843426}, {"AC", 0.3905733}, {"SU", 0.2409390}, {"CE", 0.5314366}, {"RY", 0.2762627},
                                                    {"TU", 0.1738864}, {"CA", 0.4243633}, {"IS", 1.2149040}, {"IT", 1.2222851}, {"CU", 0.1149337},
                                                    {"IM", 0.3939763}, {"LE", 0.8587437}, {"OW", 0.5455277}, {"SH", 0.4811591}, {"ED", 1.3248052},
                                                    {"IF", 0.1947355}, {"RS", 0.3518946}, {"AB", 0.2164952}, {"RU", 0.1182408}, {"WH", 0.6630976},
                                                    {"GI", 0.1091822}, {"MI", 0.2701757}, {"EC", 0.2608296}, {"AP", 0.1791106}, {"AT", 1.5224164},
                                                    {"LO", 0.4294917}, {"QU", 0.1142627}, {"RI", 0.5433230}, {"LL", 0.7411739}, {"SC", 0.1055876},
                                                    {"FF", 0.1097574}, {"GH", 0.3432195}, {"BL", 0.2468343}, {"UP", 0.2493745}, {"AN", 2.0177146},
                                                    {"TR", 0.3306142}, {"OO", 0.4246988}, {"OK", 0.1354953}, {"SE", 0.8834271}, {"IC", 0.4850414},
                                                    {"MP", 0.1502574}, {"AK", 0.1435952}, {"HI", 1.2958561}, {"FA", 0.2160639}, {"HE", 3.6071357},
                                                    {"OP", 0.1350639}, {"NT", 0.7810987}, {"CH", 0.5389135}, {"EA", 0.7690206}, {"IL", 0.3936408},
                                                    {"AY", 0.3080875}, {"UN", 0.3875538}, {"BR", 0.1393775}, {"GA", 0.1517432}, {"TY", 0.1117704},
                                                    {"DE", 0.6216869}, {"BO", 0.1853414}, {"ND", 1.4753501}, {"NY", 0.1018491}, {"RT", 0.2767899},
                                                    {"SO", 0.4954420}, {"CR", 0.1618562}, {"VE", 1.0398673}, {"ST", 1.0042082}, {"GR", 0.1434035},
                                                    {"FO", 0.4685538}, {"NI", 0.2512917}, {"WE", 0.5938881}, {"TI", 0.6167982}, {"LI", 0.4602621},
                                                    {"MA", 0.5654183}, {"RR", 0.1646361}, {"TT", 0.2426165}, {"VI", 0.1706751}, {"MY", 0.2925106},
                                                    {"EL", 0.5384822}, {"EN", 1.2625933}, {"NO", 0.6392289}, {"OD", 0.1563444}, {"PA", 0.2341810},
                                                    {"RA", 0.4437745}, {"RN", 0.1667929}, {"AL", 0.6719644}, {"SP", 0.1451769}, {"LD", 0.4214875},
                                                    {"OU", 1.7362276}, {"IO", 0.3505526}};

    QMap <QString, double> trigramsFreqsStandart = {{"THE", 1.81}, {"AND", 0.73}, {"ING", 0.72}, {"ENT", 0.42}, {"ION", 0.42}, {"HER", 0.36},
                                                    {"FOR", 0.34}, {"THA", 0.33}, {"NTH", 0.33}, {"INT", 0.32}, {"ERE", 0.31}, {"HES", 0.24},
                                                    {"TIO", 0.31}, {"VER", 0.24}, {"TER", 0.30}, {"HIS", 0.24}, {"EST", 0.28}, {"OFT", 0.22},
                                                    {"ERS", 0.28}, {"ITH", 0.21}, {"ATI", 0.26}, {"FTH", 0.21}, {"HAT", 0.26}, {"STH", 0.21},
                                                    {"ATE", 0.25}, {"OTH", 0.21}, {"ALL", 0.25}, {"RES", 0.21}, {"ETH", 0.24}, {"ONT", 0.20}};
public:
    Decryption();

    QString AtbashCipher(QString cipherText);
    QString ROT13(QString cipherText);
    QString CaesarCipher(QString cipherText);
    QString AffiliateCipher(QString cipherText);
    QString SimpleReplacementCipher(QString cipherText);
    QString PolibiyaCipher(QString cipherText);
    QString SwapCipher(QString cipherText);
    QString VigeneraCipher(QString cipherText);
};

#endif // DECRYPTION_H
